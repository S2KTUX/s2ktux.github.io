<div class="lesson-wrapper">
    <header class="lesson-header">
        <span class="badge">RHCSA Objetivo 6</span>
        <h1>Crear y configurar sistemas de archivos</h1>
        <p>Formateo, montaje, NFS, autofs y diagn√≥stico de permisos</p>
        
        <a href="https://youtu.be/gaYlseO7kus" target="_blank" class="video-card">
            <div class="video-icon">üé¨</div>
            <div class="video-text">
                <strong>VER VIDEO YOUTUBE - CLASE 6</strong>
                <span>Sistemas de archivos y almacenamiento en RHCSA</span>
            </div>
        </a>
    </header>

    <div class="lesson-layout">

        <aside class="lesson-toc">
            <h4>Objetivos del bloque</h4>
            <ul>
                <li><a href="#obj1">1. Sistemas de archivos locales</a></li>
                <li><a href="#obj2">2. Sistemas de archivos de red (NFS)</a></li>
                <li><a href="#obj3">3. Configurar autofs</a></li>
                <li><a href="#obj4">4. Ampliar vol√∫menes l√≥gicos</a></li>
                <li><a href="#obj5">5. Diagnosticar permisos</a></li>
            </ul>
        </aside>

        <div class="course-content">

           <section id="obj1" class="lesson-section">
                <h3>1. Crear, montar y desmontar sistemas de archivos locales</h3>
                 <p>Linux soporta distintos sistemas de archivos. Como vimos en la clase anterior, los m√°s comunes son <strong>ext4</strong>, <strong>xfs</strong> y <strong>vfat</strong>.</p>>
                <ul>
                    <li><strong>ext4</strong> ‚Üí Sistema est√°ndar en Linux.</li>
                    <li><strong>xfs</strong> ‚Üí Optimizado para grandes vol√∫menes (no permite reducci√≥n).</li>
                    <li><strong>vfat</strong> ‚Üí Compatible con otros sistemas operativos, com√∫n en USB.</li>
                </ul>
                 <p>Para crear un sistema de archivos utilizamos <code>mkfs</code> seg√∫n el tipo. En el ejemplo creamos dos particiones nuevas, una en ext4 y otra en xfs, y posteriormente las montamos.</p>
                <img src="/images/mkfs.png" alt="mkfs ejemplos" >
                <img src="/images/comproba-mkfs.png" alt="mkfs ejemplo comprobaci√≥n" >
                <p>Una vez formateado y montado, podemos hacerlo permanente a√±adi√©ndolo a <code>/etc/fstab</code>y para desmontar usamos <code>umount</code>.</p>
            </section>

            <section id="obj2" class="lesson-section">
                <h3>2. Montar y desmontar sistemas de archivos de red usando NFS</h3>
                 <p>NFS permite montar directorios remotos como si fueran locales. Es muy com√∫n en entornos empresariales y es un objetivo t√≠pico del examen RHCSA.</p>
                <p>Puede pedirse de dos formas:</p>
                <ul>
                    <li>Configuraci√≥n cliente-servidor real.</li>
                    <li>Configuraci√≥n completamente local.</li>
                </ul>
                 <p><strong>Configuraci√≥n en el SERVER:</strong> instalar NFS, crear directorio compartido, asignar permisos, configurar <code>/etc/exports</code> y abrir firewall.</p>
                <img src="/images/nfs-remote.png" alt="nfs remote ejemplo" >
                <p><strong>Configuraci√≥n en el CLIENTE:</strong> instalar cliente NFS, crear punto de montaje y montar manualmente o mediante <code>/etc/fstab</code>.</p>
                <img src="/images/nfs-client.png" alt="mount nfs client">
                <p>Tambi√©n pueden pedir realizar todo localmente:</p>
                <img src="/images/nfs-local.png" alt="mount nfs local" w>
                <p>El error <em>stale file handle</em> aparece cuando el recurso cambia sin desmontar previamente. Soluciones:</p>
                <ul>
                    <li><strong>exportfs -au</strong> y luego <code>exportfs -ar</code></li>
                    <li><strong>umount -f /mnt/nfs</strong></li>
                </ul>         
            </section>

            <section id="obj3" class="lesson-section">
                <h3>3. Configurar autofs</h3>
                <p><strong>autofs</strong> monta sistemas autom√°ticamente cuando se accede a ellos y los desmonta tras un tiempo de inactividad, ahorrando recursos.</p>
                <p>Existen dos tipos de mapas:</p>
                <ul>
                    <li><strong>Mapa indirecto</strong> ‚Üí Ruta base en auto.master y rutas relativas (recomendado).</li>
                    <li><strong>Mapa directo</strong> ‚Üí Usa rutas absolutas mediante /-.</li>
                </ul>
                <p>Instalamos el servicio y configuramos el archivo principal:</p>
                <img src="/images/auto-master.png" alt="autofs ejemplo" >
                
                <p>Despu√©s configuramos los mapas (las rutas deben existir previamente en <code>/etc/exports</code>):</p>

                <img src="/images/auto-indirecto.png" alt="Mapa indirecto autofs">

                <p>Ejemplo de mapas directo e indirecto :</p>

                <img src="/images/auto-direct.png" alt="Mapa directo" >
                <img src="/images/auto-ejemplo.png" alt="Resultado autofs">
                <p>Tras cualquier cambio recuerda reiniciar el servicio con <code>systemctl restart autofs</code>Evita usar mapas directo e indirecto en la misma ruta. En el examen normalmente se espera dominio del mapa indirecto.</p>
            </section>
            </section>

            <section id="obj4" class="lesson-section">
                <h3>4. Ampliar vol√∫menes l√≥gicos existentes</h3>
                <p>Este punto contin√∫a lo aprendido en la clase 5. Para ampliar almacenamiento sin p√©rdida de datos usamos <code>lvextend</code>.</p>
                <p>Cosas importantes a recordar :</p>
                <ul>
                    <li>Usar <strong>-r</strong> para ampliar filesystem autom√°ticamente.</li>
                    <li>Si no se usa, ejecutar despu√©s <code>xfs_growfs</code> o <code>resize2fs</code>.</li>
                    <li>XFS solo permite ampliar, nunca reducir.</li>
                </ul>
            </section>

            <section id="obj5" class="lesson-section">
                <h3>5. Diagnosticar y corregir problemas de permisos</h3>
                <p>Muchos errores en Linux est√°n relacionados con permisos incorrectos. Podemos analizarlos usando <code>ls -l</code></p>
                <p> Ya sabemos que los permisos se dividen en lectura (r), escritura (w) y ejecuci√≥n (x) para usuario - grupo - otros</p>
                <p>Permisos especiales:</p>

                <ul>
                    <li><strong>SUID (4)</strong> ‚Üí Ejecuta con permisos del due√±o.</li>
                    <li><strong>SGID (2)</strong> ‚Üí Ejecuta o crea archivos con permisos del grupo.</li>
                    <li><strong>Sticky Bit (1)</strong> ‚Üí Solo el due√±o puede borrar archivos.</li>
                </ul>
                <p> Para saber que tenemos los permisos especiales activos, simplemente veremos una s en SUID o SGID y una t en sticky bit</p>
                <img src="/images/permisos-spe.png" alt="permisos ejemplo">
                <p>Los ACL permiten permisos avanzados adicionales sobre usuarios concretos:</p>
                <img src="/images/acls.png" alt="acls ejemplo" >
            </section>

        </div>
    </div>
</div>
