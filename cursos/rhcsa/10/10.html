<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="RHCSA - Administrar la seguridad">
    <meta name="keywords" content="RHCSA, Linux, firewall-cmd, firewalld, umask, SSH, SELinux, contextos, booleanos">
    <meta name="author" content="S2KTUX">
    <title>S2KTUX - RHCSA | Administrar la seguridad</title>
    <link rel="stylesheet" href="/conf/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="/images/favicon.png">
</head>
<body>

<div class="gradient-bg"></div>

<header>
    <div class="header-left">
        <a href="/index.html" class="header-logo">S2KTUX</a>
    </div>
    <nav>
        <a href="/index.html">Inicio</a>
        <a href="/cursos/cursos.html">Cursos</a>
        <a href="/proyectos/proyectos.html">Proyectos</a>
    </nav>
</header>

<main id="contenido">

    <div class="hero">
        <h1>Administrar la seguridad</h1>
        <p>Firewall, Permisos de archivo, SSH y Hardening con SELinux</p>
        <p><a href="https://youtu.be/mDqQq9ZGehA" target="_blank">VER VIDEO YOUTUBE - CLASE 10</a></p>
    </div>

    <a href="/cursos/cursos.html" class="back-link">← Volver al curso RHCSA</a>

    <div class="course-page">

        <div class="sidebar">
            <h3>Objetivos del bloque</h3>
            <ul>
                <li><a href="#obj1">Firewall-cmd</a></li>
                <li><a href="#obj2">Permisos (umask)</a></li>
                <li><a href="#obj3">Claves SSH</a></li>
                <li><a href="#obj4">Modos SELinux</a></li>
                <li><a href="#obj5">Contextos SELinux</a></li>
                <li><a href="#obj6">Restaurar Contextos</a></li>
                <li><a href="#obj7">Etiquetas de Puerto</a></li>
                <li><a href="#obj8">Booleanos SELinux</a></li>
            </ul>
        </div>

        <div class="content">

            <section id="obj1">
                <h3>1. Configure la configuración del firewall usando firewall-cmd/firewalld</h3>
                <p> Lo básico lo dimos en la CLASE 8. Aqui profudizaremos con las app personalizadas, rich rules, NAT y las ipset. Es muy interesante conocer la ruta <code>/etc/firewalld/zones/"Z0NA".xml</code> donde está la configuración que hemos añadido a la zona. .</p>
                <p> Lo primero, las app personalizadas. Tenemos las del sistema en <code>/usr/lib/firewalld/services/</code> y podemos copiar cualquiera de ahi en <code>/etc/firewalld/services/</code> y modificarla con los datos que nos dijeran. Muy importante darle los contextos de SELinux (<code>restorecon -v /etc/firewalld/services/archivo.xml</code>).</p>
                <img src="/images/firewall-app.png" alt="app perso de firewall" width="1000">
                <p> Despues tenemos las rich rules, que al final simplemente son reglas mas detalladas y especificas hacia algun servicio, puerto ,ip y pueden ser todo lo simples o complejas que te puedas imaginar. Pongo varios ejemplos aunque CREO que en el examen con que sepamos de forma básica ( los 3 primeros ejemplos) es suficiente.</p>
                <img src="/images/firewall-rich.png" alt="richrules de firewall" width="1200">
                <p> NAT es esencial cuando nuestro server actual como gateway o necesitamos redirigir el trafico hacia otras maquinas. Tenemos tres maneras de hacerlo ( mencionar que en el video no comento que son formas diferentes e independientes de hacerlo) :</p>
                <ul>
                    <li><code>Masquerade</code>: Sirve para que los equipos de una red interna tengan internet a través del servidor.</li>
                    <li><code>Port Forwarding</code>: Envía el tráfico que llega a un puerto hacia otro puerto o IP.</li>
                    <li><code>NAT vía RICH RULE</code>: Hace un reenvío de puertos solo para una IP o red específica.</li>
                </ul>
                <img src="/images/firewall-nat.png" alt="nat de firewall" width="1200">
                <p>Por ultimo tenemos las IPSET, que simplemente lista de IPs que el firewall consulta de un solo golpe, lo que nos permite una gran eficiencia a la hora de crear reglas : </p>
                <img src="/images/firewall-ipset.png" alt="ipset de firewall" width="1200">
            </section>

            <section id="obj2">
                <h3>2. Administrar los permisos de archivo predeterminados</h3>
                <p>El comando <code>umask</code> controla los permisos que se le <strong>"quitan"</strong> a un archivo o directorio recién creado.</p>
                <p>El valor máximo es 666 para archivos y 777 para directorios (ya que x no se aplica por seguridad).Es decir, la regla o la suma es  Permisos totales - UMASK = Permisos reales. Si el umask es 022, el archivo se crea con 644 (666-022) y el directorio con 755 (777-022).</p>
                <p>Para aplicar un umask temporalmente hariamos <code>umask valor</code> y para aplicarlos de forma persistente añadimos umask valor al archivo <code>/etc/profile</code> de forma global o <code> ~/.bashrc</code> para un usuario especifico</p>
            </section>

            <section id="obj3">
                <h3>3. Configurar la autenticación basada en claves para SSH</h3>
                <p>Permite el acceso a servidores sin introducir contraseña, utilizando criptografía de clave pública/privada.</p>
                <ul>
                    <li><code>ssh-keygen</code>: Genera el par de claves en <code>~/.ssh/</code>.</li>
                    <li><code>ssh-copy-id usuario@servidor</code>: Copia nuestra clave pública al servidor remoto para autorizarnos.</li>
                </ul>
                <img src="/images/ssh-auth.png" alt="Autenticación SSH" width="800">
            </section>

            <section id="obj4">
                <h3>4. Configurar modos de aplicación y permisivos para SELinux</h3>
                <p>SELinux puede estar en tres estados:</p>
                <ul>
                    <li><strong>Enforcing:</strong> La política se aplica y se bloquean los accesos no permitidos.</li>
                    <li><strong>Permissive:</strong> No se bloquea nada, pero se registran los avisos en los logs.</li>
                    <li><strong>Disabled:</strong> El sistema está totalmente desactivado.</li>
                </ul>
                <p>Usamos <code>getenforce</code> para ver el modo y <code>setenforce [0|1]</code> para alternar entre Permissive (0) y Enforcing (1).</p>
                <img src="/images/selinux-modes.png" alt="Modos SELinux" width="800">
            </section>

            <section id="obj5">
                <h3>5. Enumere e identifique el contexto del archivo y proceso de SELinux</h3>
                <p>SELinux etiqueta cada recurso con un contexto (usuario:rol:tipo:nivel). El elemento más importante suele ser el <strong>tipo</strong> (type).</p>
                <ul>
                    <li><code>ls -Z</code>: Muestra el contexto de archivos y directorios.</li>
                    <li><code>ps -eZ</code>: Muestra el contexto de los procesos en ejecución.</li>
                </ul>
                <img src="/images/selinux-context.png" alt="Contextos SELinux" width="800">
            </section>

            <section id="obj6">
                <h3>6. Restaurar contextos de archivo predeterminados</h3>
                <p>Si movemos archivos o cambiamos etiquetas manualmente, podemos causar errores. <code>restorecon</code> devuelve las etiquetas originales según la política del sistema.</p>
                <ul>
                    <li><code>restorecon -v archivo</code>: Restaura el contexto del archivo mostrando el cambio.</li>
                    <li><code>restorecon -Rv /directorio</code>: Restaura contextos de forma recursiva en toda una ruta.</li>
                </ul>
                <img src="/images/restorecon.png" alt="Uso de restorecon" width="800">
            </section>

            <section id="obj7">
                <h3>7. Administrar etiquetas de puerto SELinux</h3>
                <p>Si un servicio (ej. Apache) debe escuchar en un puerto no estándar, debemos etiquetar ese puerto en SELinux.</p>
                <ul>
                    <li><code>semanage port -l | grep http</code>: Lista los puertos permitidos para http.</li>
                    <li><code>semanage port -a -t http_port_t -p tcp 8081</code>: Añade el puerto 8081 al tipo permitido por Apache.</li>
                </ul>
                <img src="/images/selinux-ports.png" alt="Puertos SELinux" width="800">
            </section>

            <section id="obj8">
                <h3>8. Utilice la configuración booleana para modificar la configuración del sistema SELinux</h3>
                <p>Los booleanos son interruptores (on/off) que permiten cambiar reglas de SELinux en tiempo real sin modificar la política completa.</p>
                <ul>
                    <li><code>getsebool -a</code>: Lista todos los booleanos disponibles.</li>
                    <li><code>setsebool nombre_booleano on/off</code>: Cambia el valor temporalmente.</li>
                    <li><code>setsebool -P nombre_booleano on</code>: Cambia el valor de forma <strong>Persistente</strong> tras reinicio.</li>
                </ul>
                <img src="/images/selinux-booleans.png" alt="Booleanos SELinux" width="800">
            </section>

        </div>
    </div>
</main>

<footer>
    <div class="footer-content">
        <p>S2KTUX | Un lugar para aprender sistemas y redes</p>
        <div class="footer-links">
            <a href="https://github.com/s2ktux">GitHub</a>
            <a href="mailto:alaisysadm@gmail.com">Contacto</a>
            <a href="https://www.youtube.com/@s2ktux">YouTube</a>
        </div>
    </div>
</footer>

<a href="#" id="back-to-top">↑ Volver arriba</a>
<script src="/conf/scripts.js"></script>

</body>
</html>
