<div class="lesson-wrapper">

    <header class="lesson-header">
        <span class="badge">RHCSA Objetivo</span>
        <h1>Implementar, configurar y mantener sistemas</h1>
        <p>Tareas programadas, servicios, paquetes y arranque</p>

        <a href="https://youtu.be/TRauHLhYB4c" target="_blank" class="video-card">
            <div class="video-icon">üé¨</div>
            <div class="video-text">
                <strong>VER VIDEO YOUTUBE - CLASE 7</strong>
                <span>Automatizaci√≥n, systemd y mantenimiento del sistema</span>
            </div>
        </a>
    </header>

    <div class="lesson-layout">

        <aside class="lesson-toc">
            <h4>Objetivos del bloque</h4>
            <ul>
                <li><a href="#obj1">1. Programar tareas</a></li>
                <li><a href="#obj2">2. Gestionar servicios</a></li>
                <li><a href="#obj3">3. Objetivo de arranque</a></li>
                <li><a href="#obj4">4. Cliente de tiempo</a></li>
                <li><a href="#obj5">5. Gesti√≥n de paquetes</a></li>
                <li><a href="#obj6">6. Gestor de arranque</a></li>
            </ul>
        </aside>

        <div class="course-content">

            <section id="obj1" class="lesson-section">
                <h3>1. Programar tareas con cron y temporizadores systemd</h3>
                 <p>En Linux podemos automatizar tareas para ejecutarlas en momentos concretos usando cron o temporizadores systemd. Aunque existe el comando at, su uso es menor.</p>
                <p>La forma cl√°sica es <strong>cron</strong> mediante <code>crontab -e</code>. Cada l√≠nea define cu√°ndo y qu√© comando ejecutar siguiendo la sintaxis: <strong>min hora d√≠a mes d√≠a-semana usuario comando</strong>.</p>
                <p>Para programar tareas podemos editar el archivo <code>/etc/crontab</code> (a√±adiendo el campo de usuario) o usar el comando <code>crontab -e -u USUARIO</code> (sin campo de usuario) donde editaremos directamente el cron de ese user, que se crean en <code>/var/spool/cron</code> :</p>
                <img src="/images/cron.png" alt="cron ejemplo">
                <p>Podemos verificar tareas con <code>crontab -l</code> y revisar logs en <code>/var/log/cron</code>. Es importante comprobar que el servicio <code>crond</code> est√© activo.</p>
                 <p>Systemd introduce los <strong>timers</strong>, una alternativa m√°s moderna y controlable ubicada normalmente en <code>/etc/systemd/system</code>.</p>
                <img src="/images/systemd-timer.png" alt="systemd timer ejemplo" width="700">
             <p>Tras configurarlos ejecutamos <code>systemctl daemon-reload</code> y comprobamos con <code>systemctl list-timers</code>. En mi ejemplo llamado app.timer buscar√° un app.service en la misma ruta y ser√° lo que ejecute como lo hayamos programado</p>
                <img src="/images/systemd-timer-status.png" alt="systemd timer ejemplo">
                <p> Deber√° estar creado el .service con el mismo nombre y activo para poder levantar el .timer</p>
            </section>

            <section id="obj2" class="lesson-section">
                <h3>2. Iniciar, detener y habilitar servicios</h3>
                  <p>Los servicios se gestionan mediante <code>systemctl</code>. Los comandos principales son:</p>
                <ul>
                    <li><strong>systemctl start servicio</strong> ‚Üí Levanta el servicio</li>
                    <li><strong>systemctl stop servicio</strong> ‚Üí Detiene el servicio</li>
                    <li><strong>systemctl restart servicio</strong> ‚Üí Reinicia el servicio</li>
                    <li><strong>systemctl status servicio</strong> ‚Üí Muestra su estado y unas lineas de log.</li>
                    <li><strong>systemctl enable servicio</strong> ‚Üí Arranque autom√°ticamente (Con --now habilitamos y levantaremos al mismo tiempo)</li>
                    <li><strong>systemctl disable servicio</strong> ‚Üí Deshabilita (No arranca al iniciar el sistema)</li>
                </ul>
                <p> Por otro lado, nos podr√≠an pedir crear un servicio. Los servicios del sistema est√°n en <code>/usr/bin/systemd/system</code>, pero donde nosotros lo creariamos ser√≠a en <code>/etc/systemd/system</code></p>
                <img src="/images/service-sctl.png" alt="systemctl ejemplo" width="700">
                <p> Tened cuidado con las mayusculas/minusculas como en ExecStart, systemd se pone tonto y tarda un rato para saltar un error haciendonos perder bastante tiempo por una tonter√≠a. Nos sale como dead ya que ya se habr√≠a ejecutado, de ah√≠ que usemos un .timer</p>
                <img src="/images/service-sctl-status.png" alt="systemctl status" width="900">
            </section>

             <section id="obj3" class="lesson-section">
                <h3>3. Configurar el sistema para iniciar en un objetivo espec√≠fico</h3>
                <p>Systemd utiliza <strong>targets</strong> para definir c√≥mo arranca el sistema. Recordabamos los m√°s importantes a tener en cuenta : </p>
                <ul>
                    <li><strong>graphical.target</strong> ‚Üí Modo gr√°fico</li>
                    <li><strong>multi-user.target</strong> ‚Üí Modo texto con red</li>
                    <li><strong>rescue.target</strong> ‚Üí Modo rescate</li>
                    <li><strong>emergency.target</strong> ‚Üí Modo m√≠nimo</li>
                </ul>
                <p>Podemos cambiar temporalmente usando <code>systemctl isolate TARGET</code> o hacerlo permanente con set-default.</p>
                <img src="/images/set-default-target.png" alt="set-default target" width="800">
                <p> En el video indico que si falla el set-default hagamos un enlace, pero no funciona bien. Es debido a que est√° mal lanzado. Los pasos correctos y simples ser√≠an : </p>
                <img src="/images/default-alt.png" alt="set-default alternative" width="800">
            </section>

            <section id="obj4" class="lesson-section">
                <h3>4. Configurar clientes de servicio de tiempo</h3>
                <p>Red Hat utiliza <strong>chrony</strong> para sincronizaci√≥n horaria. Su configuraci√≥n se encuentra en <code>/etc/chrony.conf</code>. Su sintaxis es <code>server IP iburst</code></p>
                <img src="/images/chrony.png" alt="chrony ejemplo" >
                <p>Tras configurarlo reiniciamos el servicio y verificamos con <code>chronyc sources -v</code> (Recordamos que si sale * esta OK, si sale ? es que estar√≠a mal). </p>
                <img src="/images/chrony-check.png" alt="chrony ejemplo">
                <p> Importante que a√±adais el servicio de ntp al firewall con <code>firewall-cmd --permanent --add-service=ntp</code>.</p>
                <p>Tambi√©n pueden pedir cambios de zona horaria, idioma o teclado.</p>
                <img src="/images/idioma-teclado.png" alt="teclado-idioma-zona">
                
            </section>

            <section id="obj5">
                <h3>Instalar y actualizar paquetes de software</h3>
               <p>Red Hat utiliza <code>dnf</code> como gestor de paquetes. Los repositorios se configuran en <code>/etc/yum.repos.d/</code>.</p>
                <p>Lo que nos piden en este objetivo es basicamente conocer dnf, saber crear un repositorio ( Recordad los repositorios est√°n ubicados en <code>/etc/yum.repos.d/</code>) que pedir√°n probablemente con URL o con un ISO y CDN que es el metodo oficial de REDHAT. </p>
                <p>Si trabajamos con un ISO debemos montarlo usando <code>-o loop</code> y crear el archivo .repo correspondiente:</p>
                <img src="/images/repo-iso.png" alt="iso repo ejemplo">
                <p>Tras modificar repositorios ejecutamos <code>dnf clean all</code>, <code>dnf makecache</code> y comprobamos con <code>dnf repolist</code>.</p>
                <p> Por otro lado, y MUY SEGURAMENTE nos lo pidan, acceso a los repos de REDHAT. Si el sistema es mayor a 8.8 usaremos la forma de <code>rhc</code>, si es inferior usaremos <code>subscription-manager</code>.</p>
                <p>Independientemente de la herramienta, gestionamos tres contenidos: <strong>Content</strong> (acceso a repositorios), <strong>Analytics</strong> (vulnerabilidades v√≠a Insights) y <strong>Remote-management</strong> (solo disponible en <code>rhc</code>, permite ejecutar soluciones remotas de forma automatizada).</p>
                <img src="/images/repo-rh.png" alt=" repo Redhat ejemplo rhc">
                <img src="/images/repo-sm.png" alt="repo subscription manager">
                <img src="/images/repo-sm2.png" alt="repo subscription manager 2">
            </section>

            <section id="obj6" class="lesson-section">
                <h3>6. Modificar el gestor de arranque del sistema</h3>
                 <p>El gestor de arranque es <strong>GRUB2</strong>. Podemos modificarlo editando <code>/etc/default/grub</code> o usando <code>grubby</code>.</p>
                <img src="/images/grubby.png" alt="grub ejemplo" width="1200">
                <p>Si editamos manualmente debemos regenerar la configuraci√≥n:</p>
                <p>
                    <code>grub2-mkconfig -o /boot/grub2/grub.cfg</code> (BIOS)<br>
                    <code>grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg</code> (UEFI)
                </p>
            </section>

        </div>
    </div>
</div>
